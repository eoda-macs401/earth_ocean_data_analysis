
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Linear Regression &#8212; Earth and Ocean Data Analysis - MACS 401</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="First - Markdown Assignment" href="../Assignments/first_class_assignment.html" />
    <link rel="prev" title="More Work with Time Series" href="time_series.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Earth and Ocean Data Analysis - MACS 401</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to the Jupyter Book for Earth and Ocean Data Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Readings and Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/installing_jupyterlab.html">
   Installing JupyterLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/intro_to_jupyterlab.html">
   Intro to JupyterLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/intro_to_unix.html">
   Intro to Unix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/intro_to_unix_for_Windows.html">
   Intro to Unix - For Windows Machines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_fundamentals.html">
   Python Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions_classes.html">
   Python Functions and Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reuseable_software_elements.html">
   Reuseable Software Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/python_environments.html">
   Managing Python Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data.html">
   All About Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_and_matplotlib.html">
   Numpy and Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="more_matplotlib.html">
   More Matplotlib
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Pages/pandas_intro.html">
   Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basic_pandas.html">
     Pandas Fundamentals
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/intro_to_git.html">
   Intro to Git for Version Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time_series.html">
   More Work with Time Series
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Linear Regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/first_class_assignment.html">
   First - Markdown Assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/unixchallenge.html">
   Unix Tutorial Challenge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/python_basics.html">
   Assignment 2: Basic Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/python_functions.html">
   Assignment 3: Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/boolean_logic.html">
   Assignment 4: Playing with Boolean logic.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/project_brainstorm.html">
   Assignment 5 - Data Analysis Project Brainstorm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/numpy_matplotlib.html">
   Assignment 6 - Numpy and Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/more_matplotlib.html">
   Assignment 7- More Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/basic_pandas.html">
   Assignment 8: Pandas Fundamentals with Earthquake Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/files_markdown_git.html">
   Assignment 9: Git, and Github
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/time_series.html">
   Optional Assignment 10: Time Series Play
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Project Design
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/organization_and_packaging.html">
   Organization and Packaging of Python Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/projects.html">
   Final Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Assignments/project_overview.html">
   Final Project Readme Assignment - Due 1 Week Before Final Project Due date
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/videos.html">
   EODA Class Video Links
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/cheat_sheets.html">
   Links to useful web pages and cheatsheets:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mini_modules_from_readings.html">
   Mini Python Modules - From Readings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Pages/git_gitHub_cheatsheet.html">
   Git/GitHub Cheatsheet!
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Notebooks/linear_regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FNotebooks/linear_regression.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Notebooks/linear_regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Linear Regression
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-do-you-need-regression">
     When Do You Need Regression?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-performance">
     Regression Performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-linear-regression">
   Simple Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicing-linear-regression-using-scikit-learn">
   Practicing Linear Regression using scikit-learn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#de-trend-our-sst-climate-data">
   De-trend our SST (climate!) data:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#doing-more">
   Doing more?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Linear Regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Linear Regression
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-do-you-need-regression">
     When Do You Need Regression?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-performance">
     Regression Performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-linear-regression">
   Simple Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicing-linear-regression-using-scikit-learn">
   Practicing Linear Regression using scikit-learn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#de-trend-our-sst-climate-data">
   De-trend our SST (climate!) data:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#doing-more">
   Doing more?
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="linear-regression">
<h1>Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">Â¶</a></h1>
<p>Weâ€™re going to keep working with our timeseries SST data, however, after investigating the amplitude spectra and now that we know the frequency content of our data, we can play with calculating â€˜best fitâ€™ lines via linear regression.  This second goal of this lesson can be applied to time series, or any dataset that has a dependent and independent variable (SST and time in this case, SST and distance from a river would be another good example).</p>
<p>Many of the skills outlined in this tutorial have been taken from the article <a class="reference external" href="https://realpython.com/linear-regression-in-python/">Linear Regression in Python by Real Python</a>.</p>
<p>In order to pick up roughly where we left off in the <a class="reference internal" href="time_series.html"><span class="doc std std-doc">Time Series tutorial</span></a> - weâ€™ll reload the SST dataset and resample it - this should be quick:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>

<span class="c1">#Quickly import data with the datetime as the index:</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/eoda-macs401/earth_ocean_data_analysis/main/data/ERSST_nearForks.csv&#39;</span><span class="p">,</span>  <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_reg</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;30D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
<span class="n">sst_reg</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Time&#39;&gt;
</pre></div>
</div>
<img alt="../_images/linear_regression_4_1.png" src="../_images/linear_regression_4_1.png" />
</div>
</div>
<div class="section" id="id1">
<h2>Linear Regression<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h2>
<p>As metnioned above, you can take entire courses on regression techniques. It is a fundamental component of statistics, machine learning and modeling frameworks.  Here weâ€™ll do the simplest of the simple regressions - but you should <a class="reference external" href="https://towardsdatascience.com/5-types-of-regression-and-their-properties-c5e1fa12d55e?gi=7f595db99bee">explore more discussions</a> on linear and multiple regression.</p>
<p>Generally, in regression analysis, you consider some phenomenon of interest and have a number of observations. Each observation has two or more features. Following the assumption that at least one of the features depends on the others, you try to establish a relation among them.</p>
<div class="section" id="when-do-you-need-regression">
<h3>When Do You Need Regression?<a class="headerlink" href="#when-do-you-need-regression" title="Permalink to this headline">Â¶</a></h3>
<p>Typically, you need regression to answer whether and how some phenomenon influences the other or how several variables are related. For example, you can use it to determine if and to what extent experience or gender impacts salaries.</p>
<p>Regression is also useful when you want to forecast a response using a new set of predictors. For example, you could try to predict electricity consumption of a household for the next hour given the outdoor temperature, time of day, and number of residents in that household.</p>
</div>
<div class="section" id="regression-performance">
<h3>Regression Performance<a class="headerlink" href="#regression-performance" title="Permalink to this headline">Â¶</a></h3>
<p>The variation of actual responses <span class="math notranslate nohighlight">\(y_i, i=1, ..., n,\)</span> occurs partly due to the dependence on the predictors <span class="math notranslate nohighlight">\(x_i\)</span>. However, thereâ€™s also an additional inherent variance of the output.</p>
<p>The coefficient of determination, denoted as <span class="math notranslate nohighlight">\(R^2\)</span>, tells you which amount of variation in <span class="math notranslate nohighlight">\(y\)</span> can be explained by the dependence on <span class="math notranslate nohighlight">\(x\)</span> using the particular regression model. A larger <span class="math notranslate nohighlight">\(R^2\)</span> indicates a better fit and means that the model can better explain the variation of the output with different inputs.</p>
<p>In order to quantify the fit - we can use the sum of squared residuals (SSR):
<span class="math notranslate nohighlight">\(
SSR = \sum_{i}(y_i -f(x_i))^2
\)</span></p>
<p>The value <span class="math notranslate nohighlight">\(R^2\)</span> = 1 corresponds to SSR = 0. Thatâ€™s the perfect fit, since the values of predicted and actual responses fit completely to each other.</p>
</div>
</div>
<div class="section" id="simple-linear-regression">
<h2>Simple Linear Regression<a class="headerlink" href="#simple-linear-regression" title="Permalink to this headline">Â¶</a></h2>
<p>Simple or single-variate linear regression is the simplest case of linear regression, as it has a single independent variable, <strong>x</strong> = <span class="math notranslate nohighlight">\(ğ‘¥\)</span>.</p>
<p><em>Image below <a class="reference external" href="https://realpython.com/linear-regression-in-python/">RealPython.com</a></em>
<img alt="Linear Regression" src="https://files.realpython.com/media/fig-lin-reg.a506035b654a.png" /></p>
<p>When implementing simple linear regression, <span class="math notranslate nohighlight">\(x-y\)</span> pairs are your observations, shown as green circles in the figure. For example, the leftmost observation has the input ğ‘¥ = 5 and the actual output, or response, ğ‘¦ = 5. The next one has ğ‘¥ = 15 and ğ‘¦ = 20, and so on.</p>
<p>The estimated regression function, represented by the black line, has the equation ğ‘“(ğ‘¥) = ğ‘â‚€ + ğ‘â‚ğ‘¥. Your goal is to calculate the optimal values of the predicted weights ğ‘â‚€ and ğ‘â‚ that minimize SSR and determine the estimated regression function.</p>
<p>The value of ğ‘â‚€, also called the intercept, shows the point where the estimated regression line crosses the ğ‘¦ axis. Itâ€™s the value of the estimated response ğ‘“(ğ‘¥) for ğ‘¥ = 0. The value of ğ‘â‚ determines the slope of the estimated regression line.</p>
<p>The predicted responses, shown as red squares, are the points on the regression line that correspond to the input values. For example, for the input ğ‘¥ = 5, the predicted response is ğ‘“(5) = 8.33, which the leftmost red square represents.</p>
<p>The vertical dashed grey lines represent the residuals, which can be calculated as ğ‘¦áµ¢ - ğ‘“(ğ±áµ¢) = ğ‘¦áµ¢ - ğ‘â‚€ - ğ‘â‚ğ‘¥áµ¢ for ğ‘– = 1, â€¦, ğ‘›. Theyâ€™re the distances between the green circles and red squares. When you implement linear regression, youâ€™re actually trying to minimize these distances and make the red squares as close to the predefined green circles as possible.</p>
</div>
<div class="section" id="practicing-linear-regression-using-scikit-learn">
<h2>Practicing Linear Regression using scikit-learn<a class="headerlink" href="#practicing-linear-regression-using-scikit-learn" title="Permalink to this headline">Â¶</a></h2>
<p>For this tutorial (because weâ€™re approachign the end of the quarter!) weâ€™ll engage in a simple linear regression to remove a trend from our SST data.  This is only the tip of the iceburg, and you should also check out multiple regression and polynomial regression!  Weâ€™ll do this with a new package called <a class="reference external" href="https://scikit-learn.org/stable/index.html">scikit-learn</a> - which includes many tools used in machine learning - a new statistical framework for modeling and pattern analysis in big data.</p>
<p>In order to have access to these tools, youâ€™ll need to install scikit-learn into your eoda environment in Anaconda (or whatever environment youâ€™re using for class). In your terminal or powershell try this:</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">intel</span> <span class="pre">scikit-learn</span></code></p>
<p>(itâ€™s been a while - remember to leave off the <code class="docutils literal notranslate"><span class="pre">$</span></code> prompt)</p>
<p>You may need to re-start any Jupyter Lab instances before you have access to scikit-learn modules - but then youâ€™ll import the useful tools:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="de-trend-our-sst-climate-data">
<h2>De-trend our SST (climate!) data:<a class="headerlink" href="#de-trend-our-sst-climate-data" title="Permalink to this headline">Â¶</a></h2>
<p>To get started, lets extract just our datetime times and our SST observations.  Weâ€™ve been using these in a Pandas Dataframe thus far - this should work with the SK-Learn tools. But letâ€™s also grab nd arrays of our two variables. Also note (and this is annoying) - many statistics tools do not <em>yet</em> work with datetime objects.  Thatâ€™s OK - we can move our datetime timeseries into a nd array of days from the begining of our record:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sst_reg</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span>  <span class="n">sst_reg</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="c1">#This is a little tricky - allows us to only fit one &#39;feature&#39; or independent variable - we&#39;re essentially copying our time series:</span>
<span class="c1"># Use only one feature</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sst_reg</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Using SK-learn, weâ€™ll take advantage of a linear regression object to determine our â€œbest fitâ€ line. Weâ€™ll then calcuate our model based on our observed dataset. In machine learning speak, this is called â€œtrainingâ€ our model.  Once we have a regression model, we can use it to predict our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create linear regression object</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="c1"># Train the model using the training sets</span>
<span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Make predictions using the time observations</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>OK - that seemed to work!  We are now going to explore the coefficents and plot the results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficients: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">regr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="c1"># The intercept</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">regr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>

<span class="c1"># The mean squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean squared error: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># The coefficient of determination: 1 is perfect prediction</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficient of determination: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># Plot outputs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sst_reg</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sst_reg</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Coefficients: 
 [[1.25752462e-05]]
Intercept: 
 [10.91836467]
Mean squared error: 6.20
Coefficient of determination: 0.01
</pre></div>
</div>
<img alt="../_images/linear_regression_15_1.png" src="../_images/linear_regression_15_1.png" />
</div>
</div>
<p>Are you impressed? Maybe not too impressed yet - as we are not exactly fitting our data with a straight line (this is a periodic signal after all). You can see our <span class="math notranslate nohighlight">\(R^2\)</span> and SSR are quite low and high respectively.  However in this case, we were not trying to fit our data as much as find a linear trend in our data - thsis shoudl allow us to remove the trend if we want to see what the data would look like without the effect of climate change!  Woah!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Add a column to our origional Pandas dataframe:</span>
<span class="n">sst_reg</span><span class="p">[</span><span class="s1">&#39;detrended - anomaly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sst_reg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;degrees C&#39;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">})</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/linear_regression_18_2.png" src="../_images/linear_regression_18_2.png" />
</div>
</div>
<p>Letâ€™s fix the plot so that we are comparing two anomalies relative to our first observationsst_reg.columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_reg</span><span class="p">[</span><span class="n">sst_reg</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time
1854-01-01     7.682585
1854-01-31     7.682585
1854-03-02     8.468447
1854-04-01    10.065800
1854-05-01     8.840645
1854-05-31     8.840645
1854-06-30    11.998730
1854-07-30    13.861060
1854-08-29    13.793580
1854-09-28    13.401610
Freq: 30D, Name: Extended reconstructed sea surface temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_reg</span><span class="p">[</span><span class="s1">&#39;anomaly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sst_reg</span><span class="p">[</span><span class="n">sst_reg</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">regr</span><span class="o">.</span><span class="n">intercept_</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sst_reg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;degrees C&#39;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">})</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/linear_regression_21_2.png" src="../_images/linear_regression_21_2.png" />
</div>
</div>
</div>
<div class="section" id="doing-more">
<h2>Doing more?<a class="headerlink" href="#doing-more" title="Permalink to this headline">Â¶</a></h2>
<p>There are A LOT more data analysis tasks you can engage in relating to regression. Essentially modeling your data!  In the final optional assignment, youâ€™ll have the chance to play with a few other types of regressions including higher order, <a class="reference external" href="https://towardsdatascience.com/polynomial-regression-bbe8b9d97491">polynomial regressions</a>, and <a class="reference external" href="https://datatofish.com/multiple-linear-regression-python/">multivariate regressions</a>.  Weâ€™ll also practice training your regression on a portion of your data and testing your model on a different set of data. It wouldnâ€™t hurt to take a statistics class as well - but with data analysis tools at your disposal, you shoudl be able to play with real observational data as you learn - and explore your ability to model your data in the process.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="time_series.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">More Work with Time Series</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Assignments/first_class_assignment.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">First - Markdown Assignment</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Emily Roland (Modified from https://earth-env-data-science.github.io)<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>